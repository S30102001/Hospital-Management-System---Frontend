<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>نظام جداول المناوبات</title>
  <link rel="stylesheet" href="font/css/all.min.css">
  <link rel="stylesheet" href="font/js/all.min.js">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fustat:wght@300;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <style>
    body {
      font-family: 'Fustat', sans-serif;
      background-color: #f0f4f8;
      padding: 30px;
    }

    h2 {
      text-align: center;
      margin-bottom: 30px;
      color: rgb(6, 141, 137);
      font-weight: 700;
    }

    .nav-tabs .nav-link {
      color: rgb(6, 141, 137);
      font-weight: 600;
      font-size: 16px;
    }

    .nav-tabs .nav-link.active {
      background-color: rgb(6, 141, 137);
      color: #fff;
    }

    form {
      background: #ffffff;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.07);
      margin-bottom: 30px;
    }

    input.form-control, select.form-select {
      font-size: 15px;
    }

    button {
      background-color: #10b981;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 15px;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #0f766e;
    }

    .save-btn {
      background-color: rgb(6, 141, 137);
      font-weight: bold;
    }

    table {
      width: 100%;
      background: #ffffff;
      border-collapse: collapse;
      margin-top: 20px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    }

    th, td {
      padding: 12px;
      text-align: center;
      border: 1px solid #e2e8f0;
    }

    th {
      background-color: rgb(6, 141, 137);
      color: white;
      font-weight: 600;
    }

    .success-popup, .overlay {
      display: none;
    }
    /* تغبيش الخلفية */
.overlay {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background-color: rgba(0,0,0,0.4);
  z-index: 9999;
  display: none;
}

/* مربع النجاح */
.success-popup {
  background-color: #ffffff;
  border: 3px solid #0ca5b0;
  border-radius: 20px;
  padding: 30px 40px;
  width: 350px;
  position: fixed;
  top: 50%;
  right: 50%;
  transform: translate(50%, -50%);
  text-align: center;
  box-shadow: 0 8px 30px rgba(0,0,0,0.3);
  z-index: 10000;
  display: none;
  font-family: "Almarai", sans-serif;
}

.success-popup h3 {
  color: rgb(6, 141, 137);
  margin-bottom: 10px;
  font-size: 20px;
}

.success-popup p {
  font-size: 16px;
}
.close-btn {
      position: absolute;
      top: 15px;
      left: 15px;
     background-color: #f0f4f8;
      color: #000;
      border: none;
      border-radius: 5%;
      /* width: 32px;
      height: 32px; */
      font-size: 30px;
      cursor: pointer;
    }

    .close-btn:hover {
      background: rgb(242, 241, 247);
    }
    @media (max-width: 767.98px) {
      h2 {
        font-size: 20px;
        margin-bottom: 20px;
      }

      .nav-tabs .nav-link {
        font-size: 14px;
        padding: 8px;
      }

      form {
        padding: 15px;
      }

      input.form-control, select.form-select {
        font-size: 14px;
      }

      button, .save-btn {
        width: 100%;
        font-size: 14px;
        padding: 10px;
        margin-top: 10px;
      }

      .close-btn {
        font-size: 24px;
        top: 10px;
        left: 10px;
      }

      .success-popup {
        width: 90%;
        padding: 20px;
      }

      .success-popup h3 {
        font-size: 18px;
      }

      .success-popup p {
        font-size: 14px;
      }

      th, td {
        font-size: 12px;
        padding: 8px;
      }
    }

  </style>
</head>
<body>
<div class="overlay" id="overlay"></div>
<div class="success-popup" id="popupMessage">
  <h3>✅ تم الحفظ بنجاح</h3>
  <p>تم تسجيل البيانات بنجاح.</p>
</div>


<h2><i class="bi bi-calendar-week"></i> نظام جداول المناوبات</h2>

<ul class="nav nav-tabs justify-content-center" id="tabs" role="tablist">
  <li class="nav-item">
    <button class="nav-link active" id="daily-tab" data-bs-toggle="tab" data-bs-target="#daily" type="button">مناوبة يومية</button>
  </li>
  <li class="nav-item">
    <button class="nav-link" id="monthly-tab" data-bs-toggle="tab" data-bs-target="#monthly" type="button">مناوبة شهرية</button>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane fade show active" id="daily">
    <form id="dailyForm">
     
      <input type="text" id="nurseName" class="form-control mb-3" placeholder="اسم الممرض/ ة" required />
      <input type="text" id="shiftTime" class="form-control mb-3" placeholder=" وقت المناوبة" required />
      
      <input type="date" id="shiftDate" class="form-control mb-3" required />
      <select id="room" class="form-select mb-3" required>
        <option disabled selected>اختر الغرفة</option>
        <option value="101">غرفة 101</option>
        <option value="102">غرفة 102</option>
        <option value="ICU">غرفة ICU</option>
      </select>
      <button type="submit"><i class="bi bi-plus-circle"></i> إضافة مناوبة</button> 
    </form>
    <button class="save-btn mt-2" onclick="saveDailyRoster()">
      <i class="bi bi-save2"></i> حفظ المناوبة اليومية
    </button>
  </div>

  <div class="tab-pane fade" id="monthly">
    <div id="monthlyRoster"></div>
    <button class="save-btn mt-3" onclick="saveMonthlyRoster()">
      <i class="bi bi-save2"></i> حفظ المناوبة الشهرية
    </button>
  </div>
</div>

<div class="text-center mt-4">
  <button class="btn btn-dark" onclick="goToViewPage()">
    <i class="bi bi-table"></i> عرض الجداول المحفوظة
  </button>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const dailyForm = document.getElementById('dailyForm');
  const monthlyRoster = document.getElementById('monthlyRoster');

  dailyForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const dailyRoster = JSON.parse(localStorage.getItem('dailyRoster') || '[]');
    dailyRoster.push({
      name: document.getElementById('nurseName').value,
      time: document.getElementById('shiftTime').value,
      date: document.getElementById('shiftDate').value,
      room: document.getElementById('room').value
    });
    localStorage.setItem('dailyRoster', JSON.stringify(dailyRoster));
    dailyForm.reset();
  });

  function saveDailyRoster() {
    showSuccessMessage(" تم الحفظ بنجاح", "تم تسجيل البيانات.");

  }

  function createMonthlyRoster() {
    const nurses = JSON.parse(localStorage.getItem('nurses') || '[]');
    monthlyRoster.innerHTML = '';
    for (let i = 1; i <= 30; i++) {
      const row = document.createElement('div');
      row.className = 'row mb-2';

      const label = document.createElement('div');
      label.className = 'col-2 fw-bold';
      label.textContent = `اليوم ${i}`;

      const morning = document.createElement('div');
      morning.className = 'col';
      const morningSelect = document.createElement('select');
      morningSelect.className = 'form-select';
      morningSelect.id = `morning-${i}`;
      morningSelect.innerHTML = `<option disabled selected>وردية صباحية</option>` +
        nurses.map(n => `<option value="${n.name}">${n.name}</option>`).join('');

      const evening = document.createElement('div');
      evening.className = 'col';
      const eveningSelect = document.createElement('select');
      eveningSelect.className = 'form-select';
      eveningSelect.id = `evening-${i}`;
      eveningSelect.innerHTML = `<option disabled selected>وردية مسائية</option>` +
        nurses.map(n => `<option value="${n.name}">${n.name}</option>`).join('');

      morning.appendChild(morningSelect);
      evening.appendChild(eveningSelect);

      row.appendChild(label);
      row.appendChild(morning);
      row.appendChild(evening);
      monthlyRoster.appendChild(row);
    }
  }

  function saveMonthlyRoster() {
    const roster = {};
    for (let i = 1; i <= 30; i++) {
      roster[`day-${i}`] = {
        morning: document.getElementById(`morning-${i}`).value,
        evening: document.getElementById(`evening-${i}`).value
      };
    }
    localStorage.setItem('monthlyRoster', JSON.stringify(roster));
   showSuccessMessage(" تم الحفظ بنجاح", "تم تسجيل البيانات.");

  }

  function goToViewPage() {
    window.location.href = 'nursSheft.html';
  }
  function showSuccessMessage(title, message) {
  const popup = document.getElementById('popupMessage');
  const overlay = document.getElementById('overlay');

  popup.querySelector('h3').textContent = title;
  popup.querySelector('p').textContent = message;

  popup.style.display = 'block';
  overlay.style.display = 'block';

  setTimeout(() => {
    popup.style.display = 'none';
    overlay.style.display = 'none';
  }, 3000);
}


  createMonthlyRoster();
</script>

</body>
</html>
